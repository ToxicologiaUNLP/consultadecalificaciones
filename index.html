<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Asistencia y Calificaciones - Toxicología UNLP</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link rel="icon" href="logo1.png" type="image/png" />

<link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&display=swap" rel="stylesheet">

<style>
* {
  box-sizing: border-box;
}

html, body {
  height: 100%;
  margin: 0;
}

body {
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(
    135deg,
    #087882 0%,
    #0c8c9c 40%,
    #045c63 70%,
    #04545d 100%
  );
  min-height: 100vh;
  overflow-x: hidden;
}


/* === MAIN === */
main {
  max-width: 600px;
  width: 100%;          /* ← FALTABA */
  overflow-x: hidden;  /* ← FALTABA */
  background: #f9f8f5;
  margin: 30px auto 2em auto;
  padding: 2em;
  border-radius: 16px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.18);
  position: relative;
}

/* === HEADER DENTRO DEL MAIN === */
main header {
  text-align: center;
  margin-bottom: 25px;
}

main header img {
  width: 100%;
  height: auto;
  border-radius: 16px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.18);
}

.titulo-centro {
  font-family: 'Open Sans', sans-serif;
  font-weight: 700;
  font-size: 2em;
  color: #38828f;
  margin: 20px 0 0 0;
  line-height: 1.25;
}

/* === FORM === */
label {
  font-weight: 600;
  margin-top: 1em;
  margin-bottom: 0.6em; /* separa el texto del input (el doble aprox.) */
  display: block;

}

input[type="text"],
input[type="email"] {
  width: 100%;
  padding: 0.6em;
  font-size: 1.05em;
  border: 2px solid #ccc;
  border-radius: 6px;
  box-sizing: border-box;
}

input:focus {
  border-color: #38828f;
  outline: none;
}

/* === BOTONES === */
button {
  border-radius: 6px;
  font-weight: 700;
  cursor: pointer;
  margin: 1em auto 0 auto;
  display: block;
  border: none;
}

#btnConsultar,
#btnVolver {
  background: #2d8390;
  color: white;
}

#btnConsultar {
  padding: 0.55em 1.2em;
}

#btnVolver {
  padding: 0.45em 0.9em;
  font-size: 0.85em;
}

button:hover {
  opacity: 0.9;
}

/* === RESULTADOS === */
#resultado {
  width: 100%;
  max-width: 100%;
  overflow-x: hidden;
}


#resultado strong {
  color: #000;
}

.tabla-scroll {
  width: 100%;
  max-width: 100%;
  overflow-x: auto;
  overflow-y: hidden;
}


table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 0.5em;
}


.tabla-scroll::after {
    content: "← desplazarse →";
    display: block;
    text-align: center;
    font-size: 0.75em;
    color: #777;
    margin-top: 4px;
  }

table, th, td {
  border: 1px solid #ddd;
}

th {
  background: #efefef;
  font-weight: 700;
}

th, td {
  padding: 0.6em;
  text-align: center;
  white-space: nowrap; 
}


#resultado table tbody td {
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="60" height="12"><text x="0" y="10" font-family="Segoe UI" font-size="7" fill="%23666666" fill-opacity="0.15">ToxicologíaUNLP</text></svg>');
}

/* === LINK CONDICIONES === */
.link-condiciones {
  color: #38828f;
  text-decoration: underline;
  text-decoration-thickness: 1px;
  text-underline-offset: 3px;
  cursor: pointer;
  font-weight: 600;
}

.info-institucional {
  margin-top: 1.5em;
  text-align: center;
  font-family: "Courier New", Courier, "Lucida Console", Monaco, monospace;
  font-size: 0.74em;
  line-height: 1.3;
  color: #888;
  user-select: none;
  pointer-events: none;
}


.info-institucional .link-condiciones {
  color: #38828f;
  text-decoration: underline;
  pointer-events: auto;
}


/* === ERRORES === */
#error {
  color: #cc0000;
  font-weight: 700;
  margin-top: 1em;
}

/* === LOADER === */
#loader {
  display: none;
  text-align: center;
  margin-top: 20px;
  font-size: 2em;
  font-weight: bold;
  font-family: monospace;
  letter-spacing: 0.2em;
}

@keyframes puntos {
  0% { opacity: 0; }
  50% { opacity: 1; }
  100% { opacity: 0; }
}

#loader span {
  opacity: 0;
  animation: puntos 1.5s infinite;
}

#loader span:nth-child(1) { animation-delay: 0s; }
#loader span:nth-child(2) { animation-delay: 0.3s; }
#loader span:nth-child(3) { animation-delay: 0.6s; }

/* === FOOTER === */
footer {
 background: transparent;
  color: #ffffff;
  text-align: center;
  padding: 0.8em 1em;
  font-size: 0.85em;
  margin-top: auto;
  opacity: 0.9;
  line-height: 1.4;
}

/* === MODAL === */
.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 99999;
}

.modal {
  position: relative;
  background: white;
  border-radius: 16px;
  padding: 20px;
  max-width: 600px;
  width: 100%;
  max-height: 85vh;          
  overflow-y: auto;          
  border: 5px solid #38828f;
}

/* === BOTÓN CERRAR MODAL === */
#cerrarCondiciones {
  position: sticky;         
  top: 0;
  margin-left: auto;
  width: 36px;
  height: 36px;
  background: #38828f;
  color: white;
  border-radius: 50%;
  font-size: 1.4em;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(0,0,0,0.25);
  z-index: 10;
}

#cerrarCondiciones:hover {
  background: #04545d;
}

/* === RESPONSIVE === */
@media (max-width: 600px) {
  html, body {
    overflow-x: hidden;
  }

  main {
    width: 100%;
    max-width: 100%;
    margin: 0;
    padding: 1.2em;
    border-radius: 0;
    box-shadow: none;
  }
}

  /* === SELLO DE VERIFICACIÓN INSTITUCIONAL === */

</style>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
</head>

<body>

<main>

  <header>
    <img src="logop.png" alt="Logo Cátedra" />
    <div class="titulo-centro">ASISTENCIA Y CALIFICACIONES</div>
  </header>

  <div id="contenido"></div>

</main>

<footer>© 2026 Cátedra de Toxicología, FCM - UNLP.</footer>

<!-- Modal Condiciones -->
<div class="overlay" id="modalCondiciones">
  <div class="modal">
   <span id="cerrarCondiciones">&times;</span>
    <h3>Condiciones establecidas por la Cátedra</h3>
    <p style="text-align:left; font-size:0.85em; color:#555; line-height:1.4;">
      <p><strong>Cursada regular CON examen final:</strong> El estudiante deberá cumplir el 80% de las actividades propuestas por la cátedra. Por lo tanto, podrá faltar a 1 (una) clase de Trabajos Prácticos de casos clínicos y 1 (una) Evaluación Formativa asincrónica. Además, deberá aprobar con 4 o más la evaluación parcial al finalizar la cursada, que se realizará de forma presencial y podrá rendirse hasta un máximo de 3 oportunidades sobre las 4 fechas que publicará la Cátedra. Posteriormente, el estudiante deberá presentarse a rendir el examen final en la mesa que desee.</p>

<p><strong>Promoción de cursada regular SIN examen final:</strong> El estudiante deberá cumplir el 80% de las actividades propuestas por la cátedra. Por lo tanto, podrá faltar a 1 (una) clase de integración teórica, 1 (una) clase de Trabajos Prácticos de casos clínicos y 1 (una) Evaluación Formativa asincrónica durante todo el bimestre. La asistencia al Taller de Simulación Clínica es obligatoria. Asimismo, deberá aprobar con 7 o más una evaluación conceptual de contenidos mínimos para promocionar (formato escrito), que se tomará el día martes de la sexta semana de cursada. En la instancia de parcial, deberá aprobar con 7 o más el parcial oral el día jueves de la sexta semana, pudiendo rendirse en una única oportunidad en la primera fecha de parcial que publicará la Cátedra. Si obtuviera una calificación mayor o igual a 4 y menor a 7 en el parcial oral, pasará automáticamente al sistema de promoción con examen final. Las notas no se promedian. En caso de aprobar la evaluación conceptual escrita pero obtener una calificación menor a 4 en la instancia oral, el estudiante pasará a recuperatorio de parcial la semana siguiente.</p>

  </div>
<script>
const urlBase = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vReNWOvv7g2rK58C0Ari6MtMo8LT1Si1hYRm_hueR-ad88Utj6TlK0wfMyJJEHv1Q/pub?output=csv';

async function cargarDatos(url) {
  const res = await fetch(url);
  const text = await res.text();
  return Papa.parse(text, {header:true, skipEmptyLines:true, delimiter:","});
}

async function verificarEstado() {
  try {
    const datos = await cargarDatos(urlBase + '&_ts=' + Date.now());
    const estado = datos.data[0]?.Estado?.trim().toLowerCase();
    const contenido = document.getElementById('contenido');
    if(estado === 'habilitado'){
      contenido.innerHTML = `
      <div id="formBuscador">
        <p style="color:black; margin:0.5em 0;">Ingrese sus datos de la forma solicitada y el sistema le brindará la información.</p>
        <label for="legajo">Legajo</label><input type="text" id="legajo" placeholder="12345/6" autocomplete="off" />
        <label for="email">E-mail asociado al SIU Guaraní*</label><input type="email" id="email" placeholder="alumno@gmail.com" autocomplete="off" />
        <small style="color:#555; font-size:0.9em;">*Correo electrónico que usted ha seleccionado para recibir información oficial de las cátedras.</small>
        <button id="btnConsultar">Acceder</button>
      </div>
      <div id="loader"><span>.</span><span>.</span><span>.</span></div>
      <div id="resultado"></div>
      <div id="error"></div>
      `;
      // asegurar modal cerrado por si acaso
      const modal = document.getElementById('modalCondiciones');
      if(modal) modal.style.display = 'none';

      const legajoInput = document.getElementById('legajo');
      const emailInput = document.getElementById('email');
      const btnConsultar = document.getElementById('btnConsultar');
      [legajoInput,emailInput].forEach(inp=>inp.addEventListener('keydown',e=>{if(e.key==='Enter'){e.preventDefault(); buscarNota();}}));
      btnConsultar.addEventListener('click',buscarNota);
    } else {
      contenido.innerHTML = `
        <div style="border: 2px solid #38828f; background: #f9f8f5; padding: 1.2em; border-radius: 10px; max-width: 500px; margin: 2em auto; text-align: center; font-family: 'Open Sans', sans-serif; color: #000; font-size: 1.1em; line-height: 1.5;">
          En este momento no es posible acceder a la plataforma.<br>
         Aguarde e intente ingresar en algunos minutos.
        </div>
      `;
    }
  } catch(e){ console.error(e); document.getElementById('contenido').innerHTML=`<p style="color:red; font-weight:bold; font-size:1.2em; text-align:center;">No se pudo verificar el estado de la plataforma. Intente nuevamente más tarde.</p>`;}
}

async function buscarNota(){
  const legajoInput = document.getElementById('legajo').value.trim().toLowerCase();
  const emailInput = document.getElementById('email').value.trim().toLowerCase();
  const resultado = document.getElementById('resultado');
  const errorDiv = document.getElementById('error');
  const loader = document.getElementById('loader');
  resultado.innerHTML = ""; errorDiv.textContent="";
  if(!legajoInput || !emailInput){errorDiv.textContent="Por favor, ingrese los datos requeridos."; return;}
  loader.style.display="block";
  try{
    const parsed = await cargarDatos(urlBase + '&_ts=' + Date.now());
    const columnas = parsed.meta.fields;
    const fila = parsed.data.find(row=>row['Legajo'] && row['Email'] && row['Legajo'].trim().toLowerCase()===legajoInput && row['Email'].trim().toLowerCase()===emailInput);
    loader.style.display="none";
    if(!fila){errorDiv.textContent="Datos incorrectos. Verifique e intente nuevamente."; return;}
    const primeraColumna = columnas[0];
    const nombre = fila[primeraColumna] || "Alumno";
    const columnasExcluir = ['legajo','nombre','apellido','nombre y apellido','alumno','email','estado', primeraColumna.toLowerCase()];
    const columnasVisibles = columnas.filter(col=>!columnasExcluir.includes(col.toLowerCase()) && fila[col] && fila[col].trim()!=='');
    
    document.getElementById('formBuscador').style.display = 'none';

    let tablaHTML = `<p><strong>${nombre}:</strong></p>`;
    tablaHTML += `<div class="tabla-scroll"><table><thead><tr>`;
    columnasVisibles.forEach(col=>tablaHTML+=`<th>${col}</th>`);
    tablaHTML+=`</tr></thead><tbody><tr>`;
    columnasVisibles.forEach(col=>tablaHTML+=`<td>${fila[col]}</td>`);
    tablaHTML+=`</tr></tbody></table></div>`;
    
  tablaHTML += `<button id="btnVolver">Volver</button>`;

tablaHTML += `
  <p class="info-institucional">
  Sujeto a las
  <a href="javascript:void(0)" class="link-condiciones">condiciones</a>
  establecidas por la cátedra.
  <br>
  Información verificada por el área institucional correspondiente.
</p>
`;

    resultado.innerHTML = tablaHTML;

    const btnVolver = document.getElementById('btnVolver');
    btnVolver.addEventListener('click',()=>{
      document.getElementById('formBuscador').style.display='block';
      resultado.innerHTML='';
    });

  } catch(e){loader.style.display="none"; console.error(e); errorDiv.textContent="Error al cargar los datos. Intente nuevamente.";}
}

document.addEventListener('DOMContentLoaded', ()=> {
  const modal = document.getElementById('modalCondiciones');
  if(modal) modal.style.display = 'none';

  document.addEventListener('click', (e)=>{
    const target = e.target;
    // abrir modal cuando se hace click en el enlace (puede crearse dinámicamente)
    if (target && target.classList.contains('link-condiciones')) {
  e.preventDefault();
  if (modal) modal.style.display = 'flex';
    }
    // cerrar con la X
    if(target && target.id === 'cerrarCondiciones'){
      if(modal) modal.style.display = 'none';
    }
    // cerrar si clickean en el fondo (overlay)
    if(target && target.id === 'modalCondiciones'){
      if(modal) modal.style.display = 'none';
    }
  });

});

// Mantener verificación al cargar la página
document.addEventListener('DOMContentLoaded', verificarEstado);
</script>
</body>
</html>





























































































































































































































































































































































































































































































