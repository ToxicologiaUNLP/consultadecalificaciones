<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Asistencia y Calificaciones - Toxicología UNLP</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link rel="icon" href="logo1.png" type="image/png" />

<link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&display=swap" rel="stylesheet">

<style>
html, body {
  height: 100%;
  margin: 0;
}

body {
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(
    180deg,
    #e6f1f3 0%,
    #f3f3f3 45%,
    #f9f9f9 100%
  );
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

/* === CONTENEDOR VISUAL PRINCIPAL === */
main {
  max-width: 600px;
  background: #f9f8f5;
  margin: 30px auto 2em auto;
  padding: 2em;
  border-radius: 16px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.18);
  flex-grow: 1;
  position: relative;
}

/* === HEADER VISUALMENTE DENTRO DEL MAIN === */
header {
  max-width: 600px;
  margin: 0 auto;
  padding: 30px 15px 0 15px;
  text-align: center;
}

header img {
  width: 100%;
  max-width: 100%;
  height: auto;
  border-radius: 16px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.18);
}

/* === TÍTULO === */
.titulo-centro {
  font-family: 'Open Sans', sans-serif;
  font-weight: 800;
  font-size: 2.1em;
  color: #1f3f45; /* más oscuro para contraste */
  margin: 20px 0 10px 0;
  line-height: 1.2;
}

/* === FORM === */
label {
  font-weight: 600;
  margin-top: 1em;
  display: block;
}

input[type="text"],
input[type="email"],
textarea {
  width: 100%;
  padding: 0.6em;
  font-size: 1.05em;
  border: 2px solid #ccc;
  border-radius: 6px;
}

input:focus {
  border-color: #38828f;
  outline: none;
}

/* === BOTONES === */
button {
  border-radius: 6px;
  font-weight: 700;
  cursor: pointer;
  margin: 1em auto 0 auto;
  display: block;
}

#btnConsultar,
#btnVolver {
  background: #2d8390;
  color: white;
  border: none;
}

#btnConsultar {
  padding: 0.55em 1.2em;
}

#btnVolver {
  padding: 0.45em 0.9em;
  font-size: 0.85em;
}

/* === RESULTADOS === */
#resultado {
  margin-top: 1em;
  font-size: 1.1em;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 0.5em;
}

table, th, td {
  border: 1px solid #ddd;
}

th {
  background: #efefef;
  font-weight: 700;
}

th, td {
  padding: 0.6em;
  text-align: center;
}

/* === FOOTER === */
footer {
  background: #38828f;
  color: white;
  text-align: center;
  padding: 1em;
  font-size: 0.9em;
  margin-top: auto;
}

/* === MODAL === */
.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: none;
  justify-content: center;
  align-items: center;
}

.modal {
  background: white;
  border-radius: 16px;
  padding: 20px;
  max-width: 600px;
  width: 100%;
  border: 5px solid #38828f;
}

/* === RESPONSIVE === */
@media (max-width: 600px) {
  .titulo-centro {
    font-size: 1.8em;
  }
  main {
    margin: 1em;
    padding: 1.2em;
  }
}
</style>



<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
</head>
<body>
<header>
<img src="logop.png" alt="Logo Cátedra" />
<div class="titulo-centro">ASISTENCIA Y CALIFICACIONES</div>
</header>

<main id="contenido"></main>

<footer>© 2026 Cátedra de Toxicología, Facultad de Ciencias Médicas - UNLP.</footer>

<!-- Modal Condiciones -->
<div class="overlay" id="modalCondiciones" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="tituloCondiciones">
    <span id="cerrarCondiciones" style="position:absolute; top:10px; right:15px; font-size:1.5em; font-weight:bold; cursor:pointer; display:inline-block;">&times;</span>
    <h3 id="tituloCondiciones" style="margin-top:0;">Condiciones de la Cátedra</h3>
    <p style="text-align:left; font-size:0.85em; color:#555; line-height:1.4;">
      Para aprobar la cursada cada alumno deberá:<br><br>
      <strong>Cursada regular CON examen final:</strong> El estudiante deberá cumplir el 80% de las actividades propuestas por la cátedra, por lo tanto, el estudiante puede faltar a 1(una) clase de Trabajos prácticos de casos clínicos y 1 (una) Evaluación Formativa asincrónica. También debe aprobar con 4 o más de 4 la EVALUACION PARCIAL al finalizar la cursada que se realizará de forma presencial pudiendo ser rendido hasta un máximo de 3 oportunidades de las 4 fechas que publicará la Cátedra. Luego se presentará a rendir final en la mesa que desee.<br><br>
      <strong>Promoción de cursada regular SIN examen final:</strong> El estudiante deberá cumplir el 80% de las actividades propuestas por la cátedra, por lo tanto, el estudiante puede faltar a 1 (una) Clase de integración teórica; 1 (una) clase de Trabajos prácticos de casos clínicos y 1 (una) Evaluación formativa asincrónica, en todo el bimestre. La asistencia al Taller de simulación clínica es OBLIGATORIA. También debe aprobar con 7 o más de 7 una evaluación conceptual de contenidos minimos para promocionar (formato escrito) que se tomará el día martes de la 6ta semana de cursada. Al llegar a la instancia de parcial en esas condiciones deberá aprobar con 7 o más de 7 el parcial oral el día jueves de la 6ta semana, pudiendo ser rendido en una única opción en la primera fecha de parcial que publicará la Cátedra. Si aprobara con nota superior a 4 pero menor a 7 en el parcial oral automáticamente pasa al sistema de promoción CON examen final. LAS NOTAS NO SE PROMEDIAN. Si el estudiante aprueba la evaluación conceptual escrita pero en la instancia ORAL saca una calificación menor a 4, pasará a recuperatorio de parcial la siguiente semana.
    </p>
  </div>
</div>

<script>
const urlBase = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vReNWOvv7g2rK58C0Ari6MtMo8LT1Si1hYRm_hueR-ad88Utj6TlK0wfMyJJEHv1Q/pub?output=csv';

async function cargarDatos(url) {
  const res = await fetch(url);
  const text = await res.text();
  return Papa.parse(text, {header:true, skipEmptyLines:true, delimiter:","});
}

async function verificarEstado() {
  try {
    const datos = await cargarDatos(urlBase + '&_ts=' + Date.now());
    const estado = datos.data[0]?.Estado?.trim().toLowerCase();
    const contenido = document.getElementById('contenido');
    if(estado === 'habilitado'){
      contenido.innerHTML = `
      <div id="formBuscador">
        <p style="color:black; margin:0.5em 0;">Ingrese sus datos de la forma solicitada y el sistema le brindará la información.</p>
        <label for="legajo">Legajo</label><input type="text" id="legajo" placeholder="12345/6" autocomplete="off" />
        <label for="email">E-mail asociado al SIU Guaraní*</label><input type="email" id="email" placeholder="alumno@gmail.com" autocomplete="off" />
        <small style="color:#555; font-size:0.9em;">*Correo electrónico que usted ha seleccionado para recibir información oficial de las cátedras.</small>
        <button id="btnConsultar">Acceder</button>
      </div>
      <div id="loader"><span>.</span><span>.</span><span>.</span></div>
      <div id="resultado"></div>
      <div id="error"></div>
      `;
      // asegurar modal cerrado por si acaso
      const modal = document.getElementById('modalCondiciones');
      if(modal) modal.style.display = 'none';

      const legajoInput = document.getElementById('legajo');
      const emailInput = document.getElementById('email');
      const btnConsultar = document.getElementById('btnConsultar');
      [legajoInput,emailInput].forEach(inp=>inp.addEventListener('keydown',e=>{if(e.key==='Enter'){e.preventDefault(); buscarNota();}}));
      btnConsultar.addEventListener('click',buscarNota);
    } else {
      contenido.innerHTML = `
        <div style="border: 2px solid #38828f; background: #f9f8f5; padding: 1.2em; border-radius: 10px; max-width: 500px; margin: 2em auto; text-align: center; font-family: 'Open Sans', sans-serif; color: #000; font-size: 1.1em; line-height: 1.5;">
          En este momento no es posible acceder a la plataforma.<br>
         Aguarde a la carga de calificaciones o actualización de las mismas.
        </div>
      `;
    }
  } catch(e){ console.error(e); document.getElementById('contenido').innerHTML=`<p style="color:red; font-weight:bold; font-size:1.2em; text-align:center;">No se pudo verificar el estado de la plataforma. Intente nuevamente más tarde.</p>`;}
}

async function buscarNota(){
  const legajoInput = document.getElementById('legajo').value.trim().toLowerCase();
  const emailInput = document.getElementById('email').value.trim().toLowerCase();
  const resultado = document.getElementById('resultado');
  const errorDiv = document.getElementById('error');
  const loader = document.getElementById('loader');
  resultado.innerHTML = ""; errorDiv.textContent="";
  if(!legajoInput || !emailInput){errorDiv.textContent="Por favor, ingrese los datos requeridos."; return;}
  loader.style.display="block";
  try{
    const parsed = await cargarDatos(urlBase + '&_ts=' + Date.now());
    const columnas = parsed.meta.fields;
    const fila = parsed.data.find(row=>row['Legajo'] && row['Email'] && row['Legajo'].trim().toLowerCase()===legajoInput && row['Email'].trim().toLowerCase()===emailInput);
    loader.style.display="none";
    if(!fila){errorDiv.textContent="Datos incorrectos. Verifique e intente nuevamente."; return;}
    const primeraColumna = columnas[0];
    const nombre = fila[primeraColumna] || "Alumno";
    const columnasExcluir = ['legajo','nombre','apellido','nombre y apellido','alumno','email','estado', primeraColumna.toLowerCase()];
    const columnasVisibles = columnas.filter(col=>!columnasExcluir.includes(col.toLowerCase()) && fila[col] && fila[col].trim()!=='');
    
    document.getElementById('formBuscador').style.display = 'none';

    let tablaHTML = `<p><strong>${nombre} .Su información:</strong></p>`;
    tablaHTML += `<div class="tabla-scroll"><table><thead><tr>`;
    columnasVisibles.forEach(col=>tablaHTML+=`<th>${col}</th>`);
    tablaHTML+=`</tr></thead><tbody><tr>`;
    columnasVisibles.forEach(col=>tablaHTML+=`<td>${fila[col]}</td>`);
    tablaHTML+=`</tr></tbody></table></div>`;
    
    tablaHTML+=`<button id="btnVolver">Volver</button>`;
    tablaHTML+=`<p id="mensajeCondiciones">La información presentada en esta plataforma corresponde y depende de <a id="linkCondiciones">las condiciones</a> establecidas por la cátedra.</p>`;
    resultado.innerHTML = tablaHTML;

    const btnVolver = document.getElementById('btnVolver');
    btnVolver.addEventListener('click',()=>{
      document.getElementById('formBuscador').style.display='block';
      resultado.innerHTML='';
    });

    // NOTA: el control del modal se maneja por delegación a nivel documento (ver abajo).
  } catch(e){loader.style.display="none"; console.error(e); errorDiv.textContent="Error al cargar los datos. Intente nuevamente.";}
}

/* Control robusto del modal de condiciones:
   - Nos aseguramos de que el modal esté oculto al inicio.
   - Usamos delegación de eventos para que el enlace (creado dinámicamente) abra el modal.
   - La X y hacer click fuera del modal lo cierran.
*/
document.addEventListener('DOMContentLoaded', ()=> {
  const modal = document.getElementById('modalCondiciones');
  if(modal) modal.style.display = 'none';

  document.addEventListener('click', (e)=>{
    const target = e.target;
    // abrir modal cuando se hace click en el enlace (puede crearse dinámicamente)
    if(target && target.id === 'linkCondiciones'){
      e.preventDefault();
      if(modal) modal.style.display = 'flex';
    }
    // cerrar con la X
    if(target && target.id === 'cerrarCondiciones'){
      if(modal) modal.style.display = 'none';
    }
    // cerrar si clickean en el fondo (overlay)
    if(target && target.id === 'modalCondiciones'){
      if(modal) modal.style.display = 'none';
    }
  });

});

// Mantener verificación al cargar la página
document.addEventListener('DOMContentLoaded', verificarEstado);
</script>
</body>
</html>













































































































































































































































