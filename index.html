<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Asistencia y Calificaciones - Toxicología UNLP</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link rel="icon" href="logo1.png" type="image/png" />

<link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">

<style>
html, body { height: 100%; margin: 0; }
body {
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  background: #f9f9f9;
  display: flex;
  flex-direction: column;
}
header {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
}
header img {
  max-width: 660px;
  width: 100%;
}
.titulo-centro {
  font-family: 'Open Sans', sans-serif;
  font-weight: 700;
  font-size: 2.2em;
  color: #38828f;
  text-align: center;
  margin-top: 20px;
}
main {
  max-width: 600px;
  margin: auto;
  background: #f9f8f5;
  padding: 2em;
  border-radius: 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,.15);
  flex-grow: 1;
}
label { font-weight: 600; margin-top: 1em; display: block; }
input {
  width: 100%;
  padding: .6em;
  font-size: 1.1em;
  border-radius: 5px;
  border: 2px solid #ccc;
}
button {
  margin-top: 1em;
  padding: .6em 1.2em;
  background: #2d8390;
  color: white;
  border: none;
  font-weight: 700;
  border-radius: 5px;
  cursor: pointer;
}
#resultado { margin-top: 1em; }
table {
  border-collapse: collapse;
  width: 100%;
  margin-top: .5em;
}
th, td {
  border: 1px solid #ddd;
  padding: .6em;
  text-align: center;
}
th {
  background: #f5f5f5;
}
#error { color: #c00; font-weight: 700; margin-top: 1em; }
footer {
  background: #38828f;
  color: white;
  text-align: center;
  padding: 1em;
  font-size: .9em;
}
#loader {
  display: none;
  text-align: center;
  font-size: 2em;
  margin-top: 1em;
}
.overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.6);
  justify-content: center;
  align-items: center;
  z-index: 9999;
}
.modal {
  background: white;
  max-width: 600px;
  padding: 20px;
  border-radius: 10px;
  border: 5px solid #38828f;
  position: relative;
}
</style>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
</head>

<body>
<header>
  <img src="logop.png" alt="Logo Cátedra">
  <div class="titulo-centro">ASISTENCIA Y CALIFICACIONES</div>
</header>

<main id="contenido"></main>

<footer>© 2026 Cátedra de Toxicología – Facultad de Ciencias Médicas – UNLP</footer>

<div class="overlay" id="modalCondiciones">
  <div class="modal">
    <span id="cerrarCondiciones" style="position:absolute;top:10px;right:15px;font-size:1.5em;cursor:pointer;">×</span>
    <h3>Condiciones de la Cátedra</h3>
    <p style="font-size:.85em; line-height:1.4;">
      (Texto institucional intacto tal como lo enviaste)
    </p>
  </div>
</div>

<script>
const urlCSV = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vReNWOvv7g2rK58C0Ari6MtMo8LT1Si1hYRm_hueR-ad88Utj6TlK0wfMyJJEHv1Q/pub?output=csv';

async function cargarCSV() {
  const r = await fetch(urlCSV + '&_=' + Date.now());
  const t = await r.text();
  return Papa.parse(t, { header: true, skipEmptyLines: true });
}

async function verificarEstado() {
  const datos = await cargarCSV();
  const estado = datos.data[0]?.Estado?.toLowerCase().trim();
  const c = document.getElementById('contenido');

  if (estado !== 'habilitado') {
    c.innerHTML = `<p style="text-align:center;font-weight:700;">Plataforma no disponible.</p>`;
    return;
  }

  c.innerHTML = `
    <div id="form">
      <label>Legajo</label>
      <input id="legajo">
      <label>Email SIU Guaraní</label>
      <input id="email">
      <button id="btn">Ver Calificaciones</button>
      <div id="loader">...</div>
      <div id="error"></div>
    </div>
    <div id="resultado"></div>
  `;

  document.getElementById('btn').onclick = buscar;
}

async function buscar() {
  const leg = document.getElementById('legajo').value.trim().toLowerCase();
  const mail = document.getElementById('email').value.trim().toLowerCase();
  const res = document.getElementById('resultado');
  const err = document.getElementById('error');
  err.textContent = '';
  res.innerHTML = '';

  const datos = await cargarCSV();
  const fila = datos.data.find(f =>
    f.Legajo?.toLowerCase() === leg &&
    f.Email?.toLowerCase() === mail
  );

  if (!fila) {
    err.textContent = 'Datos incorrectos.';
    return;
  }

  const nombre = fila['Nombre y Apellido'] || fila['Alumno'] || 'Alumno';

  const excluir = ['estado','legajo','email','nombre','apellido','nombre y apellido','alumno'];
  const columnas = Object.keys(fila).filter(c =>
    !excluir.includes(c.toLowerCase()) && fila[c].trim() !== ''
  );

  let html = `<p><strong>${nombre}, tus calificaciones:</strong></p>`;
  html += `<table><tr>`;
  columnas.forEach(c => html += `<th>${c}</th>`);
  html += `</tr><tr>`;
  columnas.forEach(c => html += `<td>${fila[c]}</td>`);
  html += `</tr></table>`;
  html += `<button onclick="location.reload()">Volver</button>`;
  html += `<p style="font-size:.85em;margin-top:1em;">La información depende de <a href="#" id="linkCond">las condiciones</a>.</p>`;

  res.innerHTML = html;
}

document.addEventListener('click', e => {
  if (e.target.id === 'linkCond') {
    e.preventDefault();
    document.getElementById('modalCondiciones').style.display = 'flex';
  }
  if (e.target.id === 'cerrarCondiciones' || e.target.id === 'modalCondiciones') {
    document.getElementById('modalCondiciones').style.display = 'none';
  }
});

verificarEstado();
</script>
</body>
</html>























































































































